# -*- coding: utf-8 -*-
"""
Modified from Rydberg lab tweezers_phaseAmplitudeAdjustment.py

Created on Aug 1st 2023
"""


import numpy as np
from scipy import optimize


#updated on 10/30/2020, min fn value 6942.8
phase_dict_0 = {72.5: 148.8741023994702,
 73.0: 349.9567883806162,
 73.5: 0.02509845831742826,
 74.0: 192.8963423924625,
 74.5: 292.31699240998523,
 75.0: 171.8614143230989,
 75.5: 75.5840591863581,
 76.0: 146.260112165292,
 76.5: 170.66479746101072,
 77.0: 183.67292210408237}

phase_dict_1 = {73.0: 308.516369458974,
 74.0: 337.4503024987702,
 75.0: 6.348857368342128,
 76.0: 215.2475412144325,
 77.0: 64.18152477474852}

phase_dict_2 = {70.5: 217.99506294161668,
                 73: 117.41471615711487,
                 73.5: 67.03696186208708,
                 74: 69.38947481951816,
                 74.5: 352.53899326059224,
                 75: 168.74446997146896,
                 75.5: 75.31778870904567,
                 76: 179.8468816159664,
                 76.5: 239.9533050529058,
                 77: 43.92962650499781}

#when the monitoring mirror is flipped
phase_dict_3 = {66.5: 204.96053478943685,
 69.0: 324.00666018641465,
 69.5: 162.43763569418314,
 70.0: 307.69377981547814,
 70.5: 172.3939669401085,
 71.0: 144.0027812580337,
 71.5: 24.989186740472913,
 72.0: 68.21046987356183,
 72.5: 156.01140077348964,
 73.0: 139.66313848089507}

phase_dict_4 = {70.9: 96.15066709765703,
                 73.4: 298.55380386861356,
                 73.9: 263.40820647732096,
                 74.4: 207.80543931520026,
                 74.9: 178.9130322515936,
                 75.4: 292.5172894398082,
                 75.9: 329.3903795251156,
                 76.4: 120.213335538677,
                 76.9: 302.32177306450006,
                 77.4: 159.2789777335294}

phase_dict_5 = {70.0 : 68.63765820775433,
 70.5 : 9.079334050219291,
 71.0 : 298.258528976546,
 71.5 : 181.11304503360705,
 72.0 : 230.92860802582027,
 72.5 : 304.813866991744,
 73.0 : 159.07337559625464,
 73.5 : 279.6437514471459,
 74.0 : 223.09335003201068,
 74.5 : 335.539967302278}

phase_dict_6 = {70.5: 337.7793615264221,
 71.0 : 360.0,
 71.5 : 128.6849399659141,
 72.0 : 137.5631022016933,
 72.5 : 34.48508900214535,
 73.0 : 88.99640791009865,
 73.5 : 173.4076719718469,
 74.0 : 228.78389777756905,
 74.5 : 164.68713533351936,
 75.0 : 83.1049674705877,
 75.5 : 28.25928298977137,
 76.0 : 136.9928434861609,
 76.5 : 77.05490905455129,
 77.0 : 0.0,
 77.5 : 244.79718845610202,
 78.0 : 360.0,
 78.5 : 185.25665288853392,
 79.0 : 10.141673660930334,
 79.5 : 200.50519083206618}

phase_dict_7 = {65.0 : 13.23135655867526,
 65.5 : 268.191256815426,
 66.0: 141.13653382116155,
 66.5 : 281.49295757503023,
 67.0 : 167.40316746762514,
 67.5 : 342.37685051488336,
 68.0 : 277.10184569979987,
 68.5 : 253.35030549318324,
 69.0 : 157.72678689623217,
 69.5 : 220.67627010702935,
 70.0 : 202.0743679350961,
 70.5 : 225.9601354236202,
 71.0 : 2.140605681691938,
 71.5 : 330.0819802282758,
 72.0 : 357.4325400503701,
 72.5 : 127.56012307499199,
 73.0 : 275.79274239529485,
 73.5 : 0.0,
 74.0 : 145.90024525822867,
 74.5 : 195.90746863720298}

phase_dict_8 = {70.0: 308.09917910587654,
 70.5: 0.031335842237412925,
 71.0: 134.2526812098492,
 71.5: 167.01268158107905,
 72.0: 92.51354286958393,
 72.5: 139.27802771922535,
 73.0: 237.74815782077906,
 73.5: 247.35473734394404,
 74.0: 213.78129067024105,
 74.5: 121.45981854930734,
 75.0: 136.3046433048694,
 75.5: 241.4003899989861,
 76.0: 133.8099566427223,
 76.5: 66.94217913743326,
 77.0: 349.41585896007405,
 77.5: 167.96243107365248,
 78.0: 0.6630629165077658,
 78.5: 231.76959814972122,
 79.0: 13.02065645764557,
 79.5: 190.03101519343096}

phase_dict_9 = {70.0: 204.1887889341771,
 71.0: 100.25091561360212,
 72.0: 186.64048650578903,
 73.0: 90.86140263822887,
 74.0: 88.41171785434582,
 75.0: 305.1963284427483,
 76.0: 138.9364319498382,
 77.0: 165.27647151157936,
 78.0: 238.12441472405854,
 79.0: 321.41512201713687}

phase_dict_10 = {65.5: 9.851732407548301, # Optimized with 500 tries
 66.5: 343.18666858798355,
 67.5: 305.5914746674589,
 68.5: 221.56172252128061,
 69.5: 304.8513085322173,
 70.5: 51.5331807130095,
 71.5: 298.97719764140703,
 72.5: 92.65785833385357,
 73.5: 68.95193648337978,
 74.5: 214.89925551924551}

phase_dict_10b = {65.0: 9.851732407548301, # Optimized with 0 tries
 66.0: 343.18666858798355,
 67.0: 305.5914746674589,
 68.0: 221.56172252128061,
 69.0: 304.8513085322173,
 70.0: 51.5331807130095,
 71.0: 298.97719764140703,
 72.0: 92.65785833385357,
 73.0: 68.95193648337978,
 74.0: 214.89925551924551}

phase_dict_11 = {68.0: 335.9131455461273,
 69.0: 343.8280256662928,
 70.0: 3.3494462283552635,
 71.0: 69.19715503357071,
 72.0: 327.75605375091754,
 73.0: 202.54904500170423,
 74.0: 296.74637758816806,
 75.0: 124.67427532008706,
 76.0: 129.859882450383,
 77.0: 325.6517033522079}

# phase_dict_12 = {67.5: 335,
#  68.0: 343,
#  68.5: 3.3,
#  69.0: 69,
#  69.5: 330,
#  70.0: 202,
#  70.5: 296,
#  71.0: 124,
#  71.5: 130,
#  72.0: 325}

phase_dict_12 = {67.5: 193.91354712815766,
 68.0: 344.52416975642257,
 68.5: 269.7718946173071,
 69.0: 88.30987259079234,
 69.5: 310.5789201409034,
 70.0: 10.295644566783363,
 70.5: 123.28257749448915,
 71.0: 73.6540131959177,
 71.5: 67.91144074183833,
 72.0: 315.08105821379644,
 72.5: 337.32208212243967}

# phase_dict_13 = {67.5: 45.80853678046396,
#  68.0: 85.80643803783421,
#  68.5: 316.23330004969444,
#  69.0: 4.286488757011236,
#  69.5: 145.79789098491665,
#  70.0: 146.58629989069382,
#  70.5: 124.3122172466547,
#  71.0: 294.65193440618447,
#  71.5: 151.5080715422639,
#  72.0: 18.682103314858605}

phase_dict_13 = {67.5: 9.851732407548301, # Optimized with 500 tries
 68: 343.18666858798355,
 68.5: 305.5914746674589,
 69: 221.56172252128061,
 69.5: 304.8513085322173,
 70: 51.5331807130095,
 70.5: 298.97719764140703,
 71: 92.65785833385357,
 71.5: 68.95193648337978,
 72: 214.89925551924551}

phase_dict_14 = {61.5: 347.772406838545, # Optimized wiht 500 tries
 62.5: 146.40187800473691,
 63.5: 135.76385256386695,
 64.5: 302.371307010858,
 65.5: 202.6213806233875,
 66.5: 322.4159790194808,
 67.5: 58.40758050175796,
 68.5: 347.2700855353718,
 69.5: 322.4998702957265,
 70.5: 308.88788240283225}

phase_dict_15 = {69.5: 256.78189669782125,# Optimized wiht 500 tries
 70.5: 121.73489201468901,
 71.5: 336.1210330927816,
 72.5: 143.91389116249562,
 73.5: 119.09019913287545,
 74.5: 117.53448481352943,
 75.5: 256.62181466791134,
 76.5: 302.3932556415688,
 77.5: 170.35086339093877,
 78.5: 207.95960602068138}

phase_dict_16 = {69.5: 210.87882089911938,
 70.0: 237.73581016766656,
 70.5: 56.12449586403126,
 71.0: 205.40396143547375,
 71.5: 241.48665475091357,
 72.0: 220.9320100408633,
 72.5: 30.255899410169956,
 73.0: 46.39968798546106,
 73.5: 140.55034253146505,
 78.5: 229.22548968109615}

phase_dict_17 = {69.5: 210,
 70.1: 121,
 70.7: 336,
 71.3: 143,
 71.9: 120,
 72.5: 120,
 73.1: 255,
 73.7: 300,
 74.3: 170,
 78.5: 229}

#Note: AOD central freq = 75 MHz, bandwidth = 30MHz, range = (60, 90)
phase_dict_18 = {67.5: 48.21490411058532, 68.0: 305.76394242181664, 68.5: 212.53563360751917, 69.0: 162.84051501258284, 69.5: 224.5187477844103, 70.0: 221.96795145018555, 70.5: 316.19657752504594, 71.0: 125.43357170942826, 71.5: 262.60479529395013, 74.5: 332.59513760331515}
phase_dict_18 = {67.5: 125.40379496978022, 68.0: 0.02755886912439556, 68.5: 225.23759277465993, 69.0: 47.11497598364633, 69.5: 118.10386303777655, 70.0: 252.92938095874715, 70.5: 290.979097589437, 71.0: 254.2600965879005, 71.5: 249.1079551731985, 74.5: 252.75930811415245}
phase_dict_19 = {68.5: 204.42323849431452, 68.75: 204.35931548009586, 69.0: 255.1230612424929, 69.25: 243.69850821793287, 69.5: 109.99595023708181, 69.75: 55.87798215631167, 70.0: 239.81210836557702, 70.25: 0.0, 70.5: 172.59023286114316, 74.5: 106.69102484337473}

phase_dict_20 = {65.5: 156.78663521246568, 67.5: 247.2432523205558, 69.5: 337.7651387482091, 71.5: 248.28922640265625, 73.5: 158.74625228349998}
#optimize 500 times

phase_dict_21 = {61.5: 19.136883340438946, 63.5: 164.35703960380576, 65.5: 140.63014960639953, 67.5: 294.0839726740694, 69.5: 181.0747320914332, 71.5: 287.82656435342057, 73.5: 10.441968507378586, 75.5: 286.12066083042913, 77.5: 248.08109029851826, 79.5: 221.3563514201866}
#optimize 500 times

phase_dict_22 = {69.5: 71.2870079255327, 74.5: 161.28700793362012} #optimize 500 times

phase_dict_23 = {65.5: 167.23371202483855, 67.5: 301.2053489423571, 69.5: 86.52467108351892, 71.5: 278.1473259610753, 73.5: 302.7495044887109, 75.5: 303.32718291519853, 77.5: 163.6563556206256, 79.5: 117.54722635589633, 81.5: 248.60214566598185, 83.5: 210.52176772815787}

phase_dict_24 = {64.5: 289.7668898119288, 65.5: 341.3020615066878, 66.5: 283.85281420738204, 67.5: 309.20022270768186, 68.5: 246.58830863050267, 69.5: 288.75447506615296, 70.5: 15.085900200913825, 71.5: 115.69300846292468, 72.5: 273.671042045809, 73.5: 79.68540623817286, 74.5: 167.8811919594876, 75.5: 115.29610094506995, 76.5: 297.2036006636258, 77.5: 340.29811888067087, 78.5: 270.2348107112738, 79.5: 125.9713180064236, 80.5: 71.55521240819874, 81.5: 250.1584903896888, 82.5: 151.77410293548002, 83.5: 349.0426368086325}
# 20 traps, optimize 500 times

phase_dict_25 = {60.0: 330.1965526271924, 60.5: 36.22311702479663, 61.0: 341.54146856611374, 61.5: 279.3899494844847, 62.0: 288.96003543435666, 62.5: 43.00991928970761, 63.0: 349.4755935791574, 63.5: 171.0427164372359, 64.0: 318.41985785398526, 64.5: 223.64914143764133, 65.0: 261.6136097582406, 65.5: 237.83152183992226, 66.0: 241.67985571374285, 66.5: 217.0533369348169, 67.0: 360.0, 67.5: 138.42452607042904, 68.0: 37.19494010625138, 68.5: 321.2940445353403, 69.0: 339.32796386369387, 69.5: 19.10837369574818, 70.0: 183.1603668603586, 70.5: 201.59842863009945, 71.0: 0.0, 71.5: 232.02536011747716, 72.0: 240.90412975039771, 72.5: 54.08088701376495, 73.0: 0.0, 73.5: 0.0, 74.0: 165.8246840528066, 74.5: 92.30902731676983, 75.0: 12.446361378097421, 75.5: 207.1346473870113, 76.0: 316.2607652857225, 76.5: 8.200898666658437, 77.0: 136.11919966369732, 77.5: 90.48450120357616, 78.0: 169.43460145068585, 78.5: 60.52557915037491, 79.0: 217.68179620135462, 79.5: 0.0, 80.0: 172.60573425709237, 80.5: 202.66608268143213, 81.0: 33.32972066318901, 81.5: 218.5753819548343, 82.0: 360.0, 82.5: 275.24521678072784, 83.0: 148.47962519236577, 83.5: 186.28484534496835, 84.0: 334.53870253225165, 84.5: 355.4045564680201}
# 50 traps start from 60 MHz each step 0.5 MHz, optimize 400 times

phase_dict_26 = {61.0: 328.265550306381, 61.666666666666664: 276.08602608551274, 62.333333333333336: 281.4988321838421, 63.0: 132.92040146183788, 63.666666666666664: 242.42311924952315, 64.33333333333333: 22.185448341169, 65.0: 173.41277177640976, 65.66666666666667: 302.9398133860626, 66.33333333333333: 15.639275814509249, 67.0: 263.4613131730531, 67.66666666666667: 287.63092114735923, 68.33333333333333: 201.4599775721639, 69.0: 206.9774989067338, 69.66666666666667: 204.28978571980963, 70.33333333333333: 0.0, 71.0: 162.00367563842175, 71.66666666666667: 193.37942443475728, 72.33333333333333: 130.20737502287267, 73.0: 360.0, 73.66666666666667: 197.48401056534217, 74.33333333333333: 237.53175951033217, 75.0: 65.75801755104554, 75.66666666666667: 15.506344458762294, 76.33333333333333: 154.7709560707511, 77.0: 278.8237546664119, 77.66666666666666: 278.7442421053036, 78.33333333333333: 324.7886035787779, 79.0: 182.0172668290887, 79.66666666666666: 90.82769684843534, 80.33333333333333: 288.5865512469844, 81.0: 213.96089105200215, 81.66666666666666: 323.30542638856946, 82.33333333333333: 239.520463680507, 83.0: 61.067057421827045, 83.66666666666666: 348.9270187161949, 84.33333333333333: 0.0, 85.0: 50.10345711512885, 85.66666666666666: 63.72425417056895, 86.33333333333333: 168.23108501285782, 87.0: 143.61079840994302}
# 40 traps from 61 to 87, freq = np.linspace(61,87,40), optimize 500 times (~5 um apart)

phase_dict_28 = {60.0: 27.13381538913066, 61.0: 78.37354202072493, 62.0: 103.41381311506308, 63.0: 143.29533417993525, 64.0: 167.08077988918322, 65.0: 294.14058179545947, 66.0: 88.1404935957864, 67.0: 315.7770408214842, 68.0: 116.62514352041227, 69.0: 302.9114577985724, 70.0: 357.801148337642, 71.0: 83.90850029927215, 72.0: 305.72193691425576, 73.0: 288.6346698527597, 74.0: 51.53654515120744, 75.0: 272.7252357903781, 76.0: 228.06429442158912, 77.0: 123.69840458470371, 78.0: 79.74814360167719, 79.0: 4.248064466619587}
# 20 traps start from 60 MHz, freq = np.arange(60, 80, 1)

phase_dict_29 = {65.0: 290.16776715420735, 65.7: 266.9160803491028, 66.4: 233.45834392334976, 67.1: 282.67078417312797, 67.8: 191.65905301311992, 68.5: 90.7092150235771, 69.2: 0.03864470073897424, 69.9: 154.96289546006292, 70.6: 346.4197408030488, 71.3: 183.9281674395152, 72.0: 282.2982285038724, 72.7: 71.39974322870015, 73.4: 339.5070810729397, 74.1: 339.2374632545376, 74.8: 94.4164636621565, 75.5: 118.78353406365669, 76.2: 308.36096733768005, 76.9: 1.1404980541440795, 77.6: 116.50213267038639, 78.3: 112.65771149325741}
# 20 traps start from 65 MHz, freq = np.arange(65, 79,0.7)

phase_dict_27 = {60.0: 225.07295064212218, 60.9: 29.92437593945919, 61.8: 30.50048425894945, 62.7: 219.19202405737562, 63.6: 147.43027926909897, 64.5: 357.47678535867783, 65.4: 155.54547711723887, 66.3: 283.11538676202974, 67.2: 141.721951242921, 68.1: 302.17826220027996, 69.0: 359.97942381238, 69.9: 58.75061747920977, 70.8: 233.9430364896795, 71.7: 175.43405147008613, 72.6: 142.934248141285, 73.5: 91.54516131819459, 74.4: 84.91014220019602, 75.3: 56.53084725220306, 76.2: 112.88673192285795, 77.1: 155.85891037338556}
# 20 traps start from 65 MHz, freq = np.arange(60,78,0.9)

phase_dict_30 = {60.0: 94.28134766883647, 60.5: 124.67608983707342, 61.0: 199.64999222867493, 61.5: 237.89455277121945, 62.0: 303.24275814466597, 62.5: 138.30809849556906, 63.0: 252.79548052864035, 63.5: 347.7749013816533, 64.0: 153.64690796492883, 64.5: 4.138511583521607, 65.0: 143.5711930009193, 65.5: 38.56032374343888, 66.0: 303.41242901203356, 66.5: 11.380817220374707, 67.0: 321.70545689076147, 67.5: 296.0344880555973, 68.0: 211.96965390946252, 68.5: 112.44413794102311, 69.0: 343.3304959592212, 69.5: 289.24507293650606}
# 20 traps start from 65 MHz, freq = np.arange(60,70,0.5)

phase_dict_31 = {63.0: 140.66035851195625, 63.7: 350.05177548853726, 64.4: 133.52958230355415, 65.1: 145.34969708976232, 65.8: 344.4015147133564, 66.5: 115.87464019628496, 67.2: 189.74153133139933, 67.9: 0.0, 68.6: 257.6593359525635, 69.3: 61.26064028108406, 70.0: 274.4213839309317, 70.7: 360.0, 71.4: 0.004288173820134829, 72.1: 67.49643131335047, 72.8: 74.33618605955041, 73.5: 296.31096416680606, 74.2: 263.45504979555903, 74.9: 270.69246355556226, 75.6: 127.63474204376186, 76.3: 61.8556759925056}
# 20 traps start from 60 MHz, freq = np.arange(63,70,0.5)

phase_dict_32 = {61.0: 101.25345038603879, 61.7: 189.46989410490337, 62.4: 313.5324226052995, 63.1: 333.57870941314144, 63.8: 225.42617495786777, 64.5: 162.3596818281849, 65.2: 360.0, 65.9: 149.3174911676444, 66.6: 139.6797571759199, 67.3: 134.04542107726294, 68.0: 245.2990750477654, 68.7: 31.29765343964636, 69.4: 18.719401528924156, 70.1: 83.65429084966982, 70.8: 140.86503830700025, 71.5: 0.0, 72.2: 219.55173643533084, 72.9: 73.09149365765464, 73.6: 0.750435109966152, 74.3: 360.0, 75.0: 278.01096729096383, 75.7: 278.8940904087397, 76.4: 82.92504025954092, 77.1: 270.5070395355683, 77.8: 102.86984850021639, 78.5: 110.31692373666537, 79.2: 245.5319510515488, 79.9: 20.09545015485413, 80.6: 263.3602400530971, 81.3: 2.871012961991967, 82.0: 257.5216025411982, 82.7: 0.0, 83.4: 32.395560364966485, 84.1: 0.0, 84.8: 305.08359155476126, 85.5: 104.03263730916964, 86.2: 100.27180504861211, 86.9: 110.94124988254907, 87.6: 360.0, 88.3: 108.7946034039668}
# 40 traps, freq = np.arange(61,89,0.7)

phase_dict_33 = {60.0: 81.21216456741475, 60.6: 67.74484560382885, 61.2: 146.54371128431902, 61.8: 177.6428681567614, 62.4: 44.183045993555304, 63.0: 24.271842174410175, 63.6: 195.59263151926365, 64.2: 130.22346246749578, 64.8: 100.83357180337356, 65.4: 233.4960494269159, 66.0: 261.03674693848603, 66.6: 146.2665674538097, 67.2: 288.8373358464818, 67.8: 330.8649978754664, 68.4: 0, 69.0: 240.0174582954044, 69.6: 357.4753046230814, 70.2: 117.73670687449598, 70.8: 142.02402769437703, 71.4: 239.78069688591364, 72.0: 219.795742622876, 72.6: 35.511595608154956, 73.2: 128.06263189439883, 73.8: 42.66368304926249, 74.4: 272.82752380855993, 75.0: 48.89453725103784, 75.6: 248.1127540138025, 76.2: 95.03179475466118, 76.8: 97.76246845073857, 77.4: 3.108986928352373, 78.0: 158.61193437695687, 78.6: 345.8908055276309, 79.2: 190.62975797772515, 79.8: 151.4914760461613, 80.4: 41.377294453699626, 81.0: 93.44781372713257, 81.6: 48.118518519695364, 82.2: 64.80872360910836, 82.8: 279.1247113528471, 83.4: 29.998000869580355}
# 40 traps, freq = np.arange(60,84,0.6)

phase_dict_34 = {60.0: 358.5136429226679, 61.0: 148.34504093542046, 62.0: 74.0729862135565, 63.0: 211.1095594042793, 64.0: 202.80894551619136, 65.0: 101.47312005269345, 66.0: 300.4344475302954, 67.0: 237.15696815028198, 68.0: 0.7196391701906982, 69.0: 3.797678082227911, 70.0: 16.96934356759904, 71.0: 195.84030719498128, 72.0: 249.55614955910198, 73.0: 173.52186012755894, 74.0: 310.93734217564474, 75.0: 109.53614391917182, 76.0: 170.51394694157574, 77.0: 131.36792027932438, 78.0: 78.43055322168247, 79.0: 353.57757876097213, 80.0: 68.20036897683832, 81.0: 237.29944631261037, 82.0: 106.16506777303823, 83.0: 88.04408561140569, 84.0: 141.63012374111935, 85.0: 355.20231994052585, 86.0: 57.26400406557144, 87.0: 144.42852361589246, 88.0: 252.69484937253668, 89.0: 108.95207724896862}
# 30 traps, freq = np.arange(60,90,1)

phase_dict_35 = {60.0: 277.88794695607197, 61.0: 184.4962922048127, 62.0: 130.55337227854946, 63.0: 218.85433124521296, 64.0: 91.724824398541, 65.0: 19.23080881563176, 66.0: 0.0, 67.0: 0.0, 68.0: 250.67837075450015, 69.0: 341.7474403607889, 70.0: 31.992921493473258, 71.0: 0.0, 72.0: 336.33867780691105, 73.0: 131.7311510044214, 74.0: 344.481043932943, 75.0: 0.0, 76.0: 116.55896326799278, 77.0: 127.79629319564928, 78.0: 244.55282502903924, 79.0: 282.7793890672816, 80.0: 21.24542528940087, 81.0: 240.15417158247325, 82.0: 0.0, 83.0: 100.76871052350434, 84.0: 45.37104217495677, 85.0: 203.93202841693147, 86.0: 274.56762820338815, 87.0: 138.41251333856562, 88.0: 345.434852594876}
# 29 traps, freq = np.arange(60,89,1)

phase_dict_36 = {60.0: 0.0, 61.0: 121.29080503796196, 62.0: 0.0, 63.0: 251.08261862286895, 64.0: 38.23604260440038, 65.0: 326.35128269626716, 66.0: 3.6561845558874877, 67.0: 198.72161120315985, 68.0: 284.96076302648424, 69.0: 243.01159967866636, 70.0: 0.0, 71.0: 219.7677226430575, 72.0: 174.70716318466566, 73.0: 110.77260743375837, 74.0: 265.76742835516785, 75.0: 0.0, 76.0: 151.24238224704644, 77.0: 331.72809960210435, 78.0: 314.73017371957854, 79.0: 195.17991700827503, 80.0: 208.61975489100178, 81.0: 228.89497192614178, 82.0: 0.0, 83.0: 0.0, 84.0: 326.5399007855236, 85.0: 313.02010379723214, 86.0: 90.43979928392089, 87.0: 93.13617453768028}
# 28 traps, freq = np.arange(60,88,1)

phase_dict_37 = {60.0: 0.0, 60.7: 342.96372094039793, 61.4: 92.38191321272066, 62.1: 237.59694257297622, 62.8: 164.29374456198755, 63.5: 267.91491935979633, 64.2: 11.36822129896564, 64.9: 131.29592780381088, 65.6: 282.38930892727234, 66.3: 145.104531247282, 67.0: 257.8010173535982, 67.7: 123.13082341190501, 68.4: 185.84912224598486, 69.1: 216.25564342310187, 69.8: 0.0, 70.5: 0.0, 71.2: 6.062100653123541, 71.9: 353.29955454750495, 72.6: 168.83869982806098, 73.3: 75.03378445383315, 74.0: 106.58478363362232, 74.7: 58.34481267829883, 75.4: 354.32769703094357, 76.1: 57.64138565734667, 76.8: 179.28080664448436, 77.5: 350.25600692950337, 78.2: 355.52797107557075, 78.9: 27.884799374549054, 79.6: 255.78661434495123, 80.3: 80.31997037919524, 81.0: 121.5999265045351, 81.7: 126.75179999135821, 82.4: 321.8113948954694, 83.1: 118.86385224495373, 83.8: 79.2787844305742, 84.5: 0.0, 85.2: 244.15377617400236, 85.9: 129.2892739800558, 86.6: 350.91858454240133, 87.3: 279.07117274054366}
# 40 traps, freq = np.arange(60,88,0.7)

phase_dict_38 = {60.6: 321.9829854386345, 61.3: 235.17449084432315, 62.0: 328.4503319018672}
# 3 traps, freq = [60.6, 61.3, 62]

phase_dictionaries = [phase_dict_38, phase_dict_37, phase_dict_36, phase_dict_35, phase_dict_34, phase_dict_33, phase_dict_32, phase_dict_31, phase_dict_30, phase_dict_27, phase_dict_29, phase_dict_26, phase_dict_25, phase_dict_24, phase_dict_23, phase_dict_22, phase_dict_21, phase_dict_17, phase_dict_1, phase_dict_2, phase_dict_5, phase_dict_6, phase_dict_7, phase_dict_8, phase_dict_9, phase_dict_10, phase_dict_10b, phase_dict_11, phase_dict_12, phase_dict_13, phase_dict_14, phase_dict_15, phase_dict_16, phase_dict_18, phase_dict_19, phase_dict_20, phase_dict_28] #,phase_dict_3, phase_dict_4]

#amp_dict = {
#     60.0: 0.7490241440164751,
#     61.0: 0.7078008757796327,
#     62.0: 0.720090494097406,
#     63.0: 0.7052613529872412,
#     64.0: 0.7341768211012972,
#     65.0: 0.778040002554064,
#     66.0: 0.7483291457719768,
#     67.0: 0.7457056107252535,
#     68.0: 0.7755308786582729,
#     69.0: 0.7797427570457135,
#     70.0: 0.7746141001487719,
#     71.0: 0.7453335433686529,
#     72.0: 0.7684698267210701,
#     73.0: 0.7735203916585116,
#     74.0: 0.7564075965538567,
#     75.0: 0.7751603214857797,
#     76.0: 0.8052946074955515,
#     77.0: 0.8248755924893513,
#     78.0: 0.8241768135925442,
#     79.0: 0.8288365144039795,
#     80.0: 0.8308025085459954,
#     81.0: 0.841187450954061,
#     82.0: 0.8229092461307428,
#     83.0: 0.7872350749332656,
#     84.0: 0.792405656202338,
#     85.0: 0.7736453119731455,
#     86.0: 0.7810413963617777,
#     87.0: 0.773071864543958,
#     88.0: 0.8343711241896894,
#     89.0: 0.8740391709833762,
#     90.0: 1.0
# }

#amplitude calibration obtained on 9/28/2020, bottom tweezer image
# amp_dict = {77.0: 0.9384456094752215,
#  76.5: 1.0,
#  76.0: 0.9642106573139393,
#  75.5: 0.902005876940228,
#  75.0: 0.9533207655180811,
#  74.5: 0.9374593290035979,
#  74.0: 0.8721532224678126,
#  73.5: 0.9553665891831442,
#  73.0: 0.9461067682458977,
#  72.5: 0.8765163817352597}

# #amplitude calibration obtained on 10/1/2020, second iteration, top tweezer image
# amp_dict = {72.5: 0.8648178240683039,
#  73.0: 0.9311228692713878,
#  73.5: 0.9231792149139929,
#  74.0: 0.81835983885432,
#  74.5: 0.8968563523775719,
#  75.0: 0.9978494313123173,
#  75.5: 0.9147065410339843,
#  76.0: 0.990209067250023,
#  76.5: 1.0,
#  77.0: 0.8673003192851122}

#amplitude calibration obtained on 10/5/2020, feeding back on the atom signal
# amp_dict =     {73: 1.0,
#      74: 0.870738280877003,
#      75: 0.7196712898527714,
#      76: 0.40729621274776256,
#      77: 0.6826013626398311}

#amplitude calibration obtained on 10/13/2020, using the first amp_dict amplitudes
#and correcting with shifts in the Ramsey oscillation for different traps
#but without correcting for the quadratic Zeeman shift

# amp_dict = {73: 0.6647634369324736,
#  74: 0.5195276829426677,
#  75: 0.7679110586905217,
#  76: 0.44524906334239417,
#  77: 1.0}

##########################################################################

#amplitude calibration obtained on 10/13/2020, using the first amp_dict amplitudes
#and correcting with shifts in the Ramsey oscillation for different traps
#and with correcting for the quadratic Zeeman shift. Corrections in corr_dict,
#prevampdict taken from amplitude calibration obtained on 9/28/2020 above.

# amp_dict = {}
# prevampdict = {77.0: 0.9384456094752215,
#                76.0: 0.9642106573139393,
#                75.0: 0.9533207655180811,
#                74.0: 0.8721532224678126,
#                73.0: 0.9461067682458977}
# corr_dict = {73.0: 0.9507000082662317,
#             74.0: 0.9278296662277324,
#             75.0: 0.9891134783750355,
#             76.0: 0.8429764730981057,
#             77.0: 1.0}
# for key,val in corr_dict.items():
#     amp_dict[key] = prevampdict[key] * corr_dict[key]
#amp_dict = {73.0: 0.8994637123921126,
#            74.0: 0.8092096333017518,
#            75.0: 0.9429424183887408,
#            76.0: 0.8128068992261108,
#            77.0: 0.9384456094752215}

############################################################################

#amplitude calibration obtained on 10/15/2020, using the amp_dict amplitudes
#from 10/13 aboveand correcting with shifts in the Ramsey oscillation for different traps
#and with correcting for the quadratic Zeeman shift. Corrections in corr_dict,
#prevampdict taken from amplitude calibration obtained on 10/13/2020 above.

#amp_dict = {}
#prevampdict = {73.0: 0.8994637123921126,
#               74.0: 0.8092096333017518,
#               75.0: 0.9429424183887408,
#               76.0: 0.8128068992261108,
#               77.0: 0.9384456094752215}
#corr_dict = {73: 0.9927543347884916,
#             74: 1.0,
#             75: 0.9972117419067451,
#             76: 0.9828483075307984,
#             77: 0.9982896285095302}
# for key,val in corr_dict.items():
#     amp_dict[key] = prevampdict[key] * corr_dict[key]

########## latest for 5 tweezers

# amp_dict = {73.0: 0.8929464994622189,
#             74.0: 0.8092096333017518,
#             75.0: 0.9403132515591951,
#             76.0: 0.7988658852537392,
#             77.0: 0.9368405188594185}

######### from 10/30, first for 10 tweezers

# amp_dict = {72.5: 0.8984294071079664,
#             73.0: 0.9804871945382002,
#             73.5: 0.9124528046727084,
#             74.0: 0.9256678855324856,
#             74.5: 0.9104854880070556,
#             75.0: 0.9770309183103029,
#             75.5: 0.9046601943360224,
#             76.0: 0.9117081230840373,
#             76.5: 1.0,
#             77.0: 0.8725867964816305} ## without dipole trap at 0.5V

# amp_dict = {70.5: 0.9984294071079664,
#             73.0: 0.9804871945382002,
#             73.5: 0.9124528046727084,
#             74.0: 0.9256678855324856,
#             74.5: 0.9104854880070556,
#             75.0: 0.9770309183103029,
#             75.5: 0.9046601943360224,
#             76.0: 0.9117081230840373,
#             76.5: 1.0,
#             77.0: 0.8725867964816305} ## starting point for 2020/11/30- adding reference tweezer

# amp_dict = {70.5: 0.9621881762881059,
#             73.0: 0.9794859489273955,
#             73.5: 0.9931289470581552,
#             74.0: 1.0,
#             74.5: 0.91,
#             75.0: 0.9957298338625653,
#             75.5: 0.941674237217388,
#             76.0: 0.8636530271615595,
#             76.5: 0.9479869963688436,
#             77.0: 0.907507587146916} ## 2020/11/30- moved reference tweezer off to the side  and adjusted by hand

#2020/12/16 iterating on the Ramsey phase precession measurement
# amp_dict ={70.5: 0.8221327382387105, 73: 0.8736680456556243,
#            73.5: 0.9, 74: 0.8680240724816759, 74.5: 0.7840415070574459,
#            75: 0.8694439382219571, 75.5: 0.8375000923643918, 76: 0.761536552106634,
#            76.5: 0.8269544442485267, 77: 0.7798690420801867}

#2021/01/19
# amp_dict ={70.5: 0.8243153673913384, 73: 0.8359662625391976, 73.5: 0.9,
#            74: 0.9037302901510138, 74.5: 0.8645086253250137, 75: 0.9487879837609768,
#            75.5: 0.9587073776760909, 76: 0.8456637820689497, 76.5: 0.9344665084631123, 77: 0.8909996479463121}

#2021/01/26
# amp_dict = {70.5: 0.8120849378774081, 73: 0.837886018528905, 73.5: 0.9, 74: 0.8998996776093738, 74.5: 0.8661395167207809, 75: 0.9541788142071684, 75.5: 0.9540044040994693, 76: 0.8472345897764819, 76.5: 0.9349138124540658, 77: 0.8896467861923107}

#amp_dict = {72.5: 0.8740245725431363,
#            73.0: 0.9319798147113125,
#            73.5: 0.8725674896611272,
#            74.0: 0.8709645372309103,
#            74.5: 0.9362291610420679,
#            75.0: 0.8688828140671012,
#            75.5: 0.860401726665067,
#            76.0: 0.894175948756347,
#            76.5: 1.0,
#            77.0: 0.877299961451302} ## with dipole trap 0.5V corrected

#2021/02/02
# amp_dict = {70.5: 0.7255017074317516, 73: 0.7545270031870808, 73.5: 0.7940020576895607, 74: 0.7980404979821321, 74.5: 0.7864399356036842, 75: 0.8485169735457619, 75.5: 0.8393388174449411, 76: 0.7806876557312925, 76.5: 0.8343629172894009, 77: 0.8121939580719554}

##
#amp_dict={66.5: 0.8031692570679336, 69: 0.8092359803528526, 69.5: 0.9110891351485954, 70: 0.9016506140032463, 70.5: 0.8589451878729785, 71: 0.9856436264095271, 71.5: 0.9371380668383329, 72: 0.9, 72.5: 0.9794183172797554, 73: 0.927970013495529}

#2021/02/04 - after flipping the tweezer dichroic
# amp_dict ={66.5: 0.7777258265349765, 69: 0.7613705417473895, 69.5: 0.8435020572873517, 70: 0.8356431205566629, 70.5: 0.794893447417365, 71: 0.8999999761581421, 71.5: 0.8635215860087, 72: 0.8352870287719764, 72.5: 0.9123594495766852, 73: 0.8667955532441493}

# amp_dict ={66.5: 0.79244599276479, 69: 0.7713438190496055, 69.5: 0.8612830727603346, 70: 0.8479936947864742, 70.5: 0.7990896212211845, 71: 0.9056624174118042, 71.5: 0.8626572246791389, 72: 0.8286970244984349, 72.5: 0.9024158279571418, 73: 0.8521948788948932}
# amp_dict = {66.5: 0.99, 69: 0.99, 69.5: 0.99, 70: 0.99, 70.5: 0.99, 71: 0.99, 71.5: 0.99, 72: 0.99, 72.5: 0.99, 73: 0.99}
# amp_dict = {66.5: 0.7449570934187002, 69: 0.737785323313624, 69.5: 0.8352389043153438, 70: 0.8250493286245195, 70.5: 0.7853468012164789, 71: 0.9056624174118042, 71.5: 0.8669089096534683, 72: 0.8422131773795052, 72.5: 0.9281769871351724, 73: 0.876647670531087}

# 2021/07/16 - flipping dichroic back, adjusting frequencies
# amp_dict = {70.9: 0.95,
#                 73.4: 0.95,
#                  73.9: 0.95,
#                  74.4: 0.95,
#                  74.9: 0.95,
#                  75.4: 0.95,
#                  75.9: 0.95,
#                  76.4: 0.95,
#                  76.9: 0.95,
#                  77.4: 0.95}

# 2021/07/21
# amp_dict = {70.5: 0.8223411530617516, 73: 0.8269202655552207, 73.5: 0.8847122697757797, 74: 0.8832914108277283, 74.5: 0.8590813295700457, 75: 0.949999988079071, 75.5: 0.9394529237602264, 76: 0.8481311767612347, 76.5: 0.9370779332415297, 77: 0.8865309255254072}

# 2021/07/26
# amp_dict = {70.5: 0.8140786543463744, 73: 0.8148069070131605, 73.5: 0.8663113178476358, 74: 0.8798615699037647, 74.5: 0.8537748511996863, 75: 0.949999988079071, 75.5: 0.9366592002852623, 76: 0.8460484756050208, 76.5: 0.9355626257130655, 77: 0.8909773461255351}

# amp_dict = {70.5: 0.8253836631719708, 73: 0.8330432581822667, 73.5: 0.8834584019190871, 74: 0.8944562665458711, 74.5: 0.8641577795632647, 75: 0.9638509154319763, 75.5: 0.9493245058021598, 76: 0.8484909247625173, 76.5: 0.939412682977885, 77: 0.8941029006945775}

# amp_dict = {70.5: 0.8415702835779952, 73: 0.8328749501644385, 73.5: 0.9018743691341906, 74: 0.9091445374326472, 74.5: 0.8675729705805016, 75: 0.9638509154319763, 75.5: 0.9667688536365138, 76: 0.8561162677876119, 76.5: 0.9431011166563539, 77: 0.8968273930824775}

# amp_dict = {70.5: 0.8237404873528171, 73: 0.8361980090898525, 73.5: 0.8986000083728681, 74: 0.9008404742487233, 74.5: 0.8740891125314504, 75: 0.9638509154319763, 75.5: 0.9591862571363643, 76: 0.8609273593068079, 76.5: 0.9562531038731696, 77: 0.9087418562278847}

# Last optimization before spacing out the tweezers:
# amp_dict = {74.5: 0.8616787156769945, 74.0: 0.8999999761581421, 73.5: 0.8713427458498435, 73.0: 0.8268054639505289, 72.5: 0.8397915653136094, 72.0: 0.8385073635493892, 71.5: 0.8455757669909042, 71.0: 0.8706082207541156, 70.5: 0.861416152484862, 70.0: 0.8237673009518282}

# amp_dict = {65.5: 0.9,
#   66.5: 0.9,
#   67.5: 0.9,
#   68.5: 0.9,
#   69.5: 0.9,
#   70.5: 0.9,
#   71.5: 0.9,
#   72.5: 0.9,
#   73.5: 0.9,
#   74.5: 0.9}

#{74.5: 0.8092169572419846, 73.5: 0.8274034478127364, 72.5: 0.8011831065820334, 71.5: 0.8020525299587267, 70.5: 0.8049355185049384, 69.5: 0.7980167469541399, 68.5: 0.8267371344519002, 67.5: 0.8999999761581421, 66.5: 0.8971759815150427, 65.5: 0.8981139191247092}

# amp_dict = {74.5: 0.7971551902817747, 73.5: 0.8410655919917437, 72.5: 0.8171205738550956, 71.5: 0.8089617722056817, 70.5: 0.8150170693656803, 69.5: 0.8070005658109849, 68.5: 0.825391772696407, 67.5: 0.8999999761581421, 66.5: 0.8778591112746891, 65.5: 0.8714596947019252}

# Amp dict up to 2022/12/16:
# amp_dict = {74.5: 0.8080577008906757, 73.5: 0.8298349107639014, 72.5: 0.8069410930166033, 71.5: 0.8090342937894707, 70.5: 0.8133705523182162, 69.5: 0.8088230425026118, 68.5: 0.8268822153901899, 67.5: 0.8999999761581421, 66.5: 0.8841179419514431, 65.5: 0.8762658015004844}

# amp_dict2 = {72.0: 0.8080577008906757, 71.5: 0.8298349107639014, 71: 0.8069410930166033, 70.5: 0.8090342937894707, 70: 0.8133705523182162, 69.5: 0.8088230425026118, 69.0: 0.8268822153901899, 68.5: 0.8999999761581421, 68.0: 0.8841179419514431, 67.5: 0.8762658015004844}
# amp_dict2 ={72.0: 0.8202022705967094, 71.5: 0.8544793681847273, 71.0: 0.835593479413259, 70.5: 0.811505073483143, 70.0: 0.8310466376815591, 69.5: 0.8304354604167855, 69.0: 0.8460475435442483, 68.5: 0.8999999761581421, 68.0: 0.8862823033023431, 67.5: 0.8644990931169207}

# amp_dict ={69.5: 0.7726729368367679, 70.5: 0.7857831260736271, 71.5: 0.8117332250625579, 72.5: 0.7784749983415662, 73.5: 0.7796166537796376, 74.5: 0.808492526067375, 75.5: 0.8161052932040886, 76.5: 0.8482379196856473, 77.5: 0.8888489767892511, 78.5: 0.8999999761581421}
amp_dict_1 ={74.5: 0.8999999761581421, 71.5: 0.8437356661581821, 71.0: 0.8259190509001721, 70.5: 0.8225394347654894, 70.0: 0.8322114641379137, 69.5: 0.8052045365819663, 69.0: 0.8280006338557352, 68.5: 0.8268403223984785, 68.0: 0.8067844354979709, 67.5: 0.8805111827378531}
amp_dict_2 = {68.5: 0.835958169398912, 68.75: 0.8157068239481068, 69: 0.8204461040246094, 69.25: 0.8120349053436806, 69.5: 0.8208203228954154, 69.75: 0.8109753932669737, 70: 0.8113685348416871, 70.25: 0.8034594059958938, 70.5: 0.8206591043618418, 74.5: 0.8999999761581421}

# amp_dict = {68.3: 0.8439969843585513, 68.6: 0.8219167100072354, 68.9: 0.8222064514249084, 69.2: 0.8208641103653082, 69.5: 0.8284446391808772, 69.8: 0.8177256475289721, 70.1: 0.8167145129217449, 70.4: 0.8172797802160124, 70.7: 0.8346228618009522, 74.5: 0.8999999761581421}


# amp_dict = {74.5: 0.8999999761581421, 71.5: 0.8437356661581821, 71.0: 0.8259190509001721, 70.5: 0.8225394347654894, 70.0: 0.8322114641379137, 69.5: 0.8052045365819663, 69.0: 0.8280006338557352, 68.5: 0.8268403223984785, 68.0: 0.8067844354979709, 67.5: 0.8805111827378531}

#Rydberg lab optimized amp dict for their light shift:
#amp_dict2 ={65.5: 0.8815509676933289, 66.5: 0.8775125710656112, 67.5: 0.8842497878651324, 68.5: 0.810310292693479, 69.5: 0.7886452308841309, 70.5: 0.7899756391155348, 71.5: 0.7834920234602227, 72.5: 0.7865276982111034, 73.5: 0.8126865871357669, 74.5: 0.7904933386700217}

#start with the same amp for each freq
amp_dict_3 = {69.5:0.9, 74.5:0.9}

amp_dict_4={61.5: 0.9, 63.5: 0.9, 65.5: 0.9, 67.5: 0.9, 69.5: 0.9, 71.5: 0.9, 73.5: 0.9, 75.5: 0.9, 77.5: 0.9, 79.5: 0.9}

amp_dict_5 ={65.5: 0.9, 67.5: 0.9, 69.5: 0.9, 71.5: 0.9, 73.5: 0.9}

amp_dict_6 ={65.5: 0.9, 66.5: 0.9, 67.5: 0.9, 68.5: 0.9, 69.5: 0.9, 70.5: 0.9, 71.5: 0.9, 72.5: 0.9, 73.5: 0.9, 74.5: 0.9}

amp_dict_7 = {65.5: 0.9, 67.5: 0.9, 69.5: 0.9, 71.5: 0.9, 73.5: 0.9, 75.5: 0.9, 77.5: 0.9, 79.5: 0.9, 81.5: 0.9, 83.5: 0.9}

amp_dict_8= {64.5: 0.9, 65.5: 0.9, 66.5: 0.9, 67.5: 0.9, 68.5: 0.9, 69.5: 0.9, 70.5: 0.9, 71.5: 0.9, 72.5: 0.9, 73.5: 0.9, 74.5: 0.9, 75.5: 0.9, 76.5: 0.9, 77.5: 0.9, 78.5: 0.9, 79.5: 0.9, 80.5: 0.9, 81.5: 0.9, 82.5: 0.9, 83.5: 0.9}
# 20 traps

amp_dict_9 = {60.0: 0.9, 60.5: 0.9, 61.0: 0.9, 61.5: 0.9, 62.0: 0.9, 62.5: 0.9, 63.0: 0.9, 63.5: 0.9, 64.0: 0.9, 64.5: 0.9, 65.0: 0.9, 65.5: 0.9, 66.0: 0.9, 66.5: 0.9, 67.0: 0.9, 67.5: 0.9, 68.0: 0.9, 68.5: 0.9, 69.0: 0.9, 69.5: 0.9, 70.0: 0.9, 70.5: 0.9, 71.0: 0.9, 71.5: 0.9, 72.0: 0.9, 72.5: 0.9, 73.0: 0.9, 73.5: 0.9, 74.0: 0.9, 74.5: 0.9, 75.0: 0.9, 75.5: 0.9, 76.0: 0.9, 76.5: 0.9, 77.0: 0.9, 77.5: 0.9, 78.0: 0.9, 78.5: 0.9, 79.0: 0.9, 79.5: 0.9, 80.0: 0.9, 80.5: 0.9, 81.0: 0.9, 81.5: 0.9, 82.0: 0.9, 82.5: 0.9, 83.0: 0.9, 83.5: 0.9, 84.0: 0.9, 84.5: 0.9}
# 50 traps, 0.5 MHz apart

amp_dict_10= {61.0: 0.9, 61.666666666666664: 0.9, 62.333333333333336: 0.9, 63.0: 0.9, 63.666666666666664: 0.9, 64.33333333333333: 0.9, 65.0: 0.9, 65.66666666666667: 0.9, 66.33333333333333: 0.9, 67.0: 0.9, 67.66666666666667: 0.9, 68.33333333333333: 0.9, 69.0: 0.9, 69.66666666666667: 0.9, 70.33333333333333: 0.9, 71.0: 0.9, 71.66666666666667: 0.9, 72.33333333333333: 0.9, 73.0: 0.9, 73.66666666666667: 0.9, 74.33333333333333: 0.9, 75.0: 0.9, 75.66666666666667: 0.9, 76.33333333333333: 0.9, 77.0: 0.9, 77.66666666666666: 0.9, 78.33333333333333: 0.9, 79.0: 0.9, 79.66666666666666: 0.9, 80.33333333333333: 0.9, 81.0: 0.9, 81.66666666666666: 0.9, 82.33333333333333: 0.9, 83.0: 0.9, 83.66666666666666: 0.9, 84.33333333333333: 0.9, 85.0: 0.9, 85.66666666666666: 0.9, 86.33333333333333: 0.9, 87.0: 0.9}
# 40 traps, 0.66 MHz (5 um) apart, freq = np.linspace(61, 87, 40)

amp_dict_11 = {65.0: 0.9, 65.7: 0.9, 66.4: 0.9, 67.1: 0.9, 67.8: 0.9, 68.5: 0.9, 69.2: 0.9, 69.9: 0.9, 70.6: 0.9, 71.3: 0.9, 72.0: 0.9, 72.7: 0.9, 73.4: 0.9, 74.1: 0.9, 74.8: 0.9, 75.5: 0.9, 76.2: 0.9, 76.9: 0.9, 77.6: 0.9, 78.3: 0.9}
# 20 traps start from 65 MHz, freq = np.arange(65, 79, 0.7)

amp_dict_12 = {61.0: 0.9, 61.7: 0.9, 62.4: 0.9, 63.1: 0.9, 63.8: 0.9, 64.5: 0.9, 65.2: 0.9, 65.9: 0.9, 66.6: 0.9, 67.3: 0.9, 68.0: 0.9, 68.7: 0.9, 69.4: 0.9, 70.1: 0.9, 70.8: 0.9, 71.5: 0.9, 72.2: 0.9, 72.9: 0.9, 73.6: 0.9, 74.3: 0.9, 75.0: 0.9, 75.7: 0.9, 76.4: 0.9, 77.1: 0.9, 77.8: 0.9, 78.5: 0.9, 79.2: 0.9, 79.9: 0.9, 80.6: 0.9, 81.3: 0.9, 82.0: 0.9, 82.7: 0.9, 83.4: 0.9, 84.1: 0.9, 84.8: 0.9, 85.5: 0.9, 86.2: 0.9, 86.9: 0.9, 87.6: 0.9, 88.3: 0.9}
# 40 traps start from 61 MHz, freq = np.arange(61, 89,0.7)

amp_dict_13 = {60.0: 0.9, 61.0: 0.9, 62.0: 0.9, 63.0: 0.9, 64.0: 0.9, 65.0: 0.9, 66.0: 0.9, 67.0: 0.9, 68.0: 0.9, 69.0: 0.9, 70.0: 0.9, 71.0: 0.9, 72.0: 0.9, 73.0: 0.9, 74.0: 0.9, 75.0: 0.9, 76.0: 0.9, 77.0: 0.9, 78.0: 0.9, 79.0: 0.9}
# 20 traps start from 60 MHz, freq = np.arange(60, 80, 1)

amp_dict_14 = {60.0: 0.9, 60.9: 0.9, 61.8: 0.9, 62.7: 0.9, 63.6: 0.9, 64.5: 0.9, 65.4: 0.9, 66.3: 0.9, 67.2: 0.9, 68.1: 0.9, 69.0: 0.9, 69.9: 0.9, 70.8: 0.9, 71.7: 0.9, 72.6: 0.9, 73.5: 0.9, 74.4: 0.9, 75.3: 0.9, 76.2: 0.9, 77.1: 0.9}
# 20 traps start from 60 MHz, freq = np.arange(60,78,0.9)

amp_dict_15 = {60.0: 0.9, 60.5: 0.9, 61.0: 0.9, 61.5: 0.9, 62.0: 0.9, 62.5: 0.9, 63.0: 0.9, 63.5: 0.9, 64.0: 0.9, 64.5: 0.9, 65.0: 0.9, 65.5: 0.9, 66.0: 0.9, 66.5: 0.9, 67.0: 0.9, 67.5: 0.9, 68.0: 0.9, 68.5: 0.9, 69.0: 0.9, 69.5: 0.9}
# 20 traps start from 60 MHz, freq = np.arange(60,70,0.5)

amp_dict_16 = {63.0: 0.9, 63.7: 0.9, 64.4: 0.9, 65.1: 0.9, 65.8: 0.9, 66.5: 0.9, 67.2: 0.9, 67.9: 0.9, 68.6: 0.9, 69.3: 0.9, 70.0: 0.9, 70.7: 0.9, 71.4: 0.9, 72.1: 0.9, 72.8: 0.9, 73.5: 0.9, 74.2: 0.9, 74.9: 0.9, 75.6: 0.9, 76.3: 0.9}
# 20 traps start from 60 MHz, freq = np.arange(63,77,0.7)


amp_dict_17 = {60.0: 0.9, 60.6: 0.9, 61.2: 0.9, 61.8: 0.9, 62.4: 0.9, 63.0: 0.9, 63.6: 0.9, 64.2: 0.9, 64.8: 0.9, 65.4: 0.9, 66.0: 0.9, 66.6: 0.9, 67.2: 0.9, 67.8: 0.9, 68.4: 0.9, 69.0: 0.9, 69.6: 0.9, 70.2: 0.9, 70.8: 0.9, 71.4: 0.9, 72.0: 0.9, 72.6: 0.9, 73.2: 0.9, 73.8: 0.9, 74.4: 0.9, 75.0: 0.9, 75.6: 0.9, 76.2: 0.9, 76.8: 0.9, 77.4: 0.9, 78.0: 0.9, 78.6: 0.9, 79.2: 0.9, 79.8: 0.9, 80.4: 0.9, 81.0: 0.9, 81.6: 0.9, 82.2: 0.9, 82.8: 0.9, 83.4: 0.9}
# 40 traps, freq = np.arange(60,84,0.6)

amp_dict_18 = {60.0: 0.9, 61.0: 0.9, 62.0: 0.9, 63.0: 0.9, 64.0: 0.9, 65.0: 0.9, 66.0: 0.9, 67.0: 0.9, 68.0: 0.9, 69.0: 0.9, 70.0: 0.9, 71.0: 0.9, 72.0: 0.9, 73.0: 0.9, 74.0: 0.9, 75.0: 0.9, 76.0: 0.9, 77.0: 0.9, 78.0: 0.9, 79.0: 0.9, 80.0: 0.9, 81.0: 0.9, 82.0: 0.9, 83.0: 0.9, 84.0: 0.9, 85.0: 0.9, 86.0: 0.9, 87.0: 0.9, 88.0: 0.9, 89.0: 0.9}
# 30 traps, freq = np.arange(60,90,1)

amp_dict_19 = {60.0: 0.9, 61.0: 0.9, 62.0: 0.9, 63.0: 0.9, 64.0: 0.9, 65.0: 0.9, 66.0: 0.9, 67.0: 0.9, 68.0: 0.9, 69.0: 0.9, 70.0: 0.9, 71.0: 0.9, 72.0: 0.9, 73.0: 0.9, 74.0: 0.9, 75.0: 0.9, 76.0: 0.9, 77.0: 0.9, 78.0: 0.9, 79.0: 0.9, 80.0: 0.9, 81.0: 0.9, 82.0: 0.9, 83.0: 0.9, 84.0: 0.9, 85.0: 0.9, 86.0: 0.9, 87.0: 0.9, 88.0: 0.9}
# 29 traps, freq = np.arange(60,89,1)

amp_dict_20 = {60.0: 0.9, 61.0: 0.9, 62.0: 0.9, 63.0: 0.9, 64.0: 0.9, 65.0: 0.9, 66.0: 0.9, 67.0: 0.9, 68.0: 0.9, 69.0: 0.9, 70.0: 0.9, 71.0: 0.9, 72.0: 0.9, 73.0: 0.9, 74.0: 0.9, 75.0: 0.9, 76.0: 0.9, 77.0: 0.9, 78.0: 0.9, 79.0: 0.9, 80.0: 0.9, 81.0: 0.9, 82.0: 0.9, 83.0: 0.9, 84.0: 0.9, 85.0: 0.9, 86.0: 0.9, 87.0: 0.9}
# 28 traps, freq = np.arange(60,88,1)


amp_dict_21 = {60.0: 0.9, 60.7: 0.9, 61.4: 0.9, 62.1: 0.9, 62.8: 0.9, 63.5: 0.9, 64.2: 0.9, 64.9: 0.9, 65.6: 0.9, 66.3: 0.9, 67.0: 0.9, 67.7: 0.9, 68.4: 0.9, 69.1: 0.9, 69.8: 0.9, 70.5: 0.9, 71.2: 0.9, 71.9: 0.9, 72.6: 0.9, 73.3: 0.9, 74.0: 0.9, 74.7: 0.9, 75.4: 0.9, 76.1: 0.9, 76.8: 0.9, 77.5: 0.9, 78.2: 0.9, 78.9: 0.9, 79.6: 0.9, 80.3: 0.9, 81.0: 0.9, 81.7: 0.9, 82.4: 0.9, 83.1: 0.9, 83.8: 0.9, 84.5: 0.9, 85.2: 0.9, 85.9: 0.9, 86.6: 0.9, 87.3: 0.9}
# 40 traps, freq = np.arange(60,88,0.7)

amp_dict_22 = {60.6:0.9, 61.3:0.9, 62.0:0.9}


amp_dictionaries = [amp_dict_22, amp_dict_21, amp_dict_20, amp_dict_19, amp_dict_18, amp_dict_17, amp_dict_16, amp_dict_14, amp_dict_15, amp_dict_11, amp_dict_1, amp_dict_2, amp_dict_3, amp_dict_4, amp_dict_5, amp_dict_6, amp_dict_7, amp_dict_8, amp_dict_9, amp_dict_10, amp_dict_12, amp_dict_13]

def trap_phase(frequencies):
    frequencies = [float(i) for i in frequencies]
    #print(f"TW_x_freqs = {frequencies}")
    frequencies.sort()
    print('freq = ',frequencies)

    phases = None
    for phase_dict in phase_dictionaries:
        d_keys = list(phase_dict.keys())
        d_keys.sort()
        # print(len(d_keys))

        # print('frequencies - dkeys: ', np.array(np.round(frequencies,2)- np.array(np.round(d_keys,2))))
        try:
            if np.all(np.round(frequencies,6) == d_keys): #  #
                print('frequencies: ', frequencies)
                print('d_keys:', d_keys)
                phases = [phase_dict[i] for i in np.round(frequencies,6)]
                break
                # else:
                    # if np.all(d_keys == np.arange(65, 79, 0.7)):
                    #     print('frequencies: ', frequencies)
                    #     print('d_keys:', d_keys)
        except:
            continue

    if not phases:
        raise Exception("ALL BAD NO GOOD, nah fam you need phases for these new frequencies")


    return phases

def trap_amplitude(frequencies):
    frequencies = [float(i) for i in frequencies]
    frequencies.sort()

    amplitudes = None
    for amp_dict in amp_dictionaries:
        d_keys = list(amp_dict.keys())
        d_keys.sort()

        try:
            if np.all(np.round(frequencies,6) == d_keys):
                amplitudes = [amp_dict[i] for i in np.round(frequencies,6)]
                break
        except:
            continue

    if not amplitudes:
        raise Exception("ALL BAD NO GOOD, nah fam you need amplitudes for these new frequencies")
    return np.array(amplitudes)

def triangle_amplitude(freq):
    if freq<75:
        return np.sqrt(0.5+0.5*(freq-60)/15)
    else:
        return np.sqrt(0.5+0.5*(90-freq)/15)